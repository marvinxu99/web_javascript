<!DOCTYPE html>
<!-- saved from url=(0070)http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/ -->
<html itemscope="itemscope" itemtype="http://schema.org/Article" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style id="stndz-style">div[class*="item-container-obpd"], a[data-redirect*="paid.outbrain.com"], a[onmousedown*="paid.outbrain.com"] { display: none !important; } a div[class*="item-container-ad"] { height: 0px !important; overflow: hidden !important; position: absolute !important; } div[data-item-syndicated="true"] { display: none !important; } .grv_is_sponsored { display: none !important; } .zergnet-widget-related { display: none !important; } </style>
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>JavaScript. The Core: 2nd Edition – Dmitry Soshnikov</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://dmitrysoshnikov.com/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://dmitrysoshnikov.com/wp-content/themes/independent-publisher/js/html5.js" type="text/javascript"></script>
	<![endif]-->
	<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Dmitry Soshnikov » Feed" href="http://dmitrysoshnikov.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Dmitry Soshnikov » Comments Feed" href="http://dmitrysoshnikov.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Dmitry Soshnikov » JavaScript. The Core: 2nd Edition Comments Feed" href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/dmitrysoshnikov.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.3"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="dpsp-frontend-style-css" href="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/style-frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="independent-publisher-style-css" href="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/style.css" type="text/css" media="all">
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/jquery.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/jquery-migrate.min.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/front-end.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/fade-post-title.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/enhanced-comment-form.js.download"></script>
<link rel="https://api.w.org/" href="http://dmitrysoshnikov.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://dmitrysoshnikov.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://dmitrysoshnikov.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Syntax: language agnostic parser generator" href="http://dmitrysoshnikov.com/compilers/syntax-language-agnostic-parser-generator/">
<link rel="next" title="JavaScript. Ядро: 2-ое издание" href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition-rus/">
<meta name="generator" content="WordPress 4.9.3">
<link rel="canonical" href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/">
<link rel="shortlink" href="http://wp.me/pPEDO-PP">
<link rel="alternate" type="application/json+oembed" href="http://dmitrysoshnikov.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdmitrysoshnikov.com%2Fecmascript%2Fjavascript-the-core-2nd-edition%2F">
<link rel="alternate" type="text/xml+oembed" href="http://dmitrysoshnikov.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdmitrysoshnikov.com%2Fecmascript%2Fjavascript-the-core-2nd-edition%2F&amp;format=xml">
<style type="text/css" data-source="Social Pug"></style><meta name="twitter:card" content="summary_large_image"><meta property="og:url" content="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript. The Core: 2nd Edition"><meta property="og:description" content="Read this article in: Russian, Chinese, German. This is the second edition of the JavaScript."><meta property="og:image" content="">

		<!--WordPress Theme Customizer CSS-->
		<style type="text/css">

			/* Background Color */

			
			/* Comment Form Background Color */

			
			/* Text Color */

															
			/* Link Color */

			a, a:visited, a:hover, a:focus, a:active { color:#284a66; }
			.enhanced-excerpts .enhanced-excerpt-read-more a, .enhanced-excerpts .enhanced-excerpt-read-more a:hover { color:#284a66; }
			.post-excerpts .sticky.format-standard .entry-content a, .post-excerpts .sticky.format-standard .entry-content a:focus, .post-excerpts .sticky.format-standard .entry-content a:hover, .post-excerpts .sticky.format-standard .entry-content a:active, .post-excerpts .sticky.format-standard .entry-content a:visited { color:#284a66; }
			.post-excerpts .format-standard.show-full-content-first-post .entry-content a { color:#284a66; }
			.post-excerpts .format-standard .entry-content a.moretag { color:#284a66; }
			.post-excerpts .format-standard .entry-content a.more-link { color:#284a66; }
			.read-more a, .read-more a:hover { color:#284a66; }
			.entry-title a:hover { color:#284a66; }
			.entry-meta a:hover { color:#284a66; }
			.site-footer a:hover { color:#284a66; }
			blockquote { border-color:#284a66; }
			#infinite-footer .blog-credits a, #infinite-footer .blog-credits a:hover { color:#284a66; }
			#nprogress .bar { background:#284a66; }
			#nprogress .spinner-icon { border-top-color:#284a66; }
			#nprogress .spinner-icon { border-left-color:#284a66; }
			#nprogress .peg { box-shadow:0 0 10px #284a66, 0 0 5px #284a66; }

			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background:#284a66; /* Old browsers */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: -moz-linear-gradient(top, #284a66 60%, #284a66 100%); /* FF3.6+ */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: -webkit-gradient(linear, left top, left bottom, color-stop(60%, #284a66), color-stop(100%, #284a66)); /* Chrome,Safari4+ */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: -webkit-linear-gradient(top, #284a66 60%, #284a66 100%); /* Chrome10+,Safari5.1+ */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: -o-linear-gradient(top, #284a66 60%, #284a66 100%); /* Opera 11.10+ */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: -ms-linear-gradient(top, #284a66 60%, #284a66 100%); /* IE10+ */ }
			button, html input[type="button"], input[type="reset"], input[type="submit"], button:hover, html input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background: linear-gradient(top, #284a66 60%, #284a66 100%); /* W3C */ }

			/* Header Text Color */

																		
			/* Primary Meta Text Color */

									
			/* Secondary Meta Text Color */

																											
		</style>
		<!--/WordPress Theme Customizer CSS-->

	<link rel="stylesheet" type="text/css" href="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shCore.css"><link rel="stylesheet" type="text/css" href="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="post-template-default single single-post postid-3213 single-format-standard single-column-layout" itemscope="itemscope" itemtype="http://schema.org/WebPage">



<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner" itemscope="" itemtype="http://schema.org/WPHeader">

		<div class="site-header-info">
													<a class="site-logo" href="http://dmitrysoshnikov.com/">
			<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c.jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100">		</a>

		<h1 class="site-title"><span class="byline"><span class="author vcard"><a class="url fn n" href="http://dmitrysoshnikov.com/" title="View all posts by Dmitry Soshnikov" rel="author">Dmitry Soshnikov</a></span></span></h1>
		<h2 class="site-description">Software engineer interested in learning and education. Sometimes blog on topics of programming languages theory, compilers, and ECMAScript.</h2>

		
		<div class="site-published-separator"></div>
		<h2 class="site-published">Published</h2>
		<h2 class="site-published-date"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/" title="JavaScript. The Core: 2nd Edition" rel="bookmark"><time class="entry-date" datetime="2017-11-14T18:06:21+00:00" pubdate="pubdate">2017-11-14</time></a></h2>
				
								</div>

				
			</header>
	<!-- #masthead .site-header -->

	<div id="main" class="site-main">
	<div id="primary" class="content-area">
		<main id="content" class="site-content" role="main">

			
				
<article id="post-3213" class="post-3213 post type-post status-publish format-standard hentry category-ecmascript tag-closure tag-core tag-ecmascript tag-funarg tag-javascript tag-lexical-environment tag-prototype tag-this" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
		<header class="entry-header">
			<h2 class="entry-title-meta">
			<span class="entry-title-meta-author">
				<span class="byline"><span class="author vcard"><a class="url fn n" href="http://dmitrysoshnikov.com/" title="View all posts by Dmitry Soshnikov" rel="author">Dmitry Soshnikov</a></span></span>			</span>
			in <a href="http://dmitrysoshnikov.com/category/ecmascript/" title="View all posts in ECMAScript">ECMAScript</a>			<span class="entry-title-meta-post-date">
				<span class="sep"> | </span>
				<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/" title="JavaScript. The Core: 2nd Edition" rel="bookmark"><time class="entry-date" datetime="2017-11-14T18:06:21+00:00" pubdate="pubdate">2017-11-14</time></a>			</span>
					</h2>
		<h1 class="entry-title" itemprop="name">JavaScript. The Core: 2nd Edition</h1>
		</header>
	<!-- .entry-header -->
	<div class="entry-content" itemprop="mainContentOfPage">
		<div id="dpsp-content-top" class="dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background"><ul class="dpsp-networks-btns-wrapper dpsp-networks-btns-content "><li><a rel="nofollow" href="https://twitter.com/intent/tweet?text=JavaScript.+The+Core%3A+2nd+Edition&amp;url=http%3A%2F%2Fdmitrysoshnikov.com%2Fecmascript%2Fjavascript-the-core-2nd-edition%2F" class="dpsp-network-btn dpsp-twitter dpsp-no-label dpsp-first"><span class="dpsp-network-icon"></span><span class="dpsp-network-label-wrapper"><span class="dpsp-network-label"></span></span></a></li><li><a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fdmitrysoshnikov.com%2Fecmascript%2Fjavascript-the-core-2nd-edition%2F&amp;t=JavaScript.+The+Core%3A+2nd+Edition" class="dpsp-network-btn dpsp-facebook dpsp-no-label"><span class="dpsp-network-icon"></span><span class="dpsp-network-label-wrapper"><span class="dpsp-network-label"></span></span></a></li><li><a rel="nofollow" href="https://plus.google.com/share?url=http%3A%2F%2Fdmitrysoshnikov.com%2Fecmascript%2Fjavascript-the-core-2nd-edition%2F" class="dpsp-network-btn dpsp-google-plus dpsp-no-label dpsp-last"><span class="dpsp-network-icon"></span><span class="dpsp-network-label-wrapper"><span class="dpsp-network-label"></span></span></a></li></ul></div><p>Read this article in: <a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition-rus/">Russian</a>, <a href="http://www.xiaojichao.com/post/jscorev2.html">Chinese</a>, <a href="https://molily.de/javascript-core/2/">German</a>.</p>
<p>This is the <em>second edition</em> of the <a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core/">JavaScript. The Core</a> overview lecture, devoted to ECMAScript programming language and core components of its runtime system.</p>
<p><span id="more-3213"></span></p>
<p><strong>Audience:</strong> advanced engineers, experts.</p>
<div class="ds-toc"><ol><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#object" title="Object">Object</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#prototype" title="Prototype">Prototype</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#class" title="Class">Class</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#execution-context" title="Execution context">Execution context</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#environment" title="Environment">Environment</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#closure" title="Closure">Closure</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#this" title="This">This</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#realm" title="Realm">Realm</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#job" title="Job">Job</a></li><li><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#agent" title="Agent">Agent</a></li></ol></div><p></p>
<p>The <a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core/">first edition</a> of the article covers generic aspects of JS language, using abstractions mostly from the legacy ES3 spec, with some references to the appropriate changes in ES5 and ES6 (aka ES2015).</p>
<p>Starting since ES2015, the specification changed descriptions and structures of some core components, introduced new models, etc. And in this edition we focus on the newer abstractions, updated terminology, but still maintaining the very basic JS structures which stay consistent throughout the spec versions.</p>
<p>This article covers ES2017+ runtime system.</p>
<p class="note">
<strong>Note:</strong> the latest version of the <a href="https://tc39.github.io/ecma262/">ECMAScript specification</a> can be found on the TC-39 website.
</p>
<p>We start our discussion with the concept of an <em>object</em>, which is fundamental to ECMAScript.</p>
<h2 id="object" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#object">Object</a></h2>
<p>ECMAScript is an <em>object-oriented</em> programming language with the <em>prototype-based</em> organization, having the concept of an <em>object</em> as its core abstraction.</p>
<p class="definition">
  <b>Def. 1: Object:</b> An <em>object</em> is a <em>collection of properties</em>, and has a <em>single prototype object</em>. The prototype may be either an object or the <code>null</code> value.
</p>
<p>Let’s take a basic example of an object. A prototype of an object is referenced by the internal <code>[[Prototype]]</code> property, which to user-level code is exposed via the <code>__proto__</code> property.</p>
<p>For the code:</p>
<div><div id="highlighter_699513" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">point = {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">x: 10,</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">y: 20,</code></div><div class="line number4 index3 alt1"><code class="jscript plain">};</code></div></div></td></tr></tbody></table></div></div>
<p>we have the structure with two <em>explicit own properties</em> and one <em>implicit</em> <code>__proto__</code> property, which is the reference to the prototype of <code>point</code>:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/js-object.png" width="500" alt="Figure 1. A basic object with a prototype." title="Figure 1. A basic object with a prototype."></p>
<p class="figure">Figure 1. A basic object with a prototype.</p>
<p class="note"><strong>Note:</strong> objects may store also <em>symbols</em>. You can get more info on symbols in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol">this documentation</a>.</p>
<p>The prototype objects are used to implement <em>inheritance</em> with the mechanism of <em>dynamic dispatch</em>. Let’s consider the <em>prototype chain</em> concept to see this mechanism in detail.</p>
<h2 id="prototype" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#prototype">Prototype</a></h2>
<p>Every object, when is created, receives its <em>prototype</em>. If the prototype is not set <em>explicitly</em>, objects receive <em>default prototype</em> as their <em>inheritance object</em>.</p>
<p class="definition">
  <b>Def. 2: Prototype:</b> A <em>prototype</em> is a delegation object used to implement <em>prototype-based inheritance</em>.
</p>
<p>The prototype can be set <em>explicitly</em> via either the <code>__proto__</code> property, or <code>Object.create</code> method:</p>
<div><div id="highlighter_776363" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Base object.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">point = {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">x: 10,</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">y: 20,</code></div><div class="line number5 index4 alt2"><code class="jscript plain">};</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript comments">// Inherit from `point` object.</code></div><div class="line number8 index7 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">point3D = {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">z: 30,</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">__proto__: point,</code></div><div class="line number11 index10 alt2"><code class="jscript plain">};</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript plain">console.log(</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">point3D.x, </code><code class="jscript comments">// 10, inherited</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">point3D.y, </code><code class="jscript comments">// 20, inherited</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">point3D.z&nbsp; </code><code class="jscript comments">// 30, own</code></div><div class="line number17 index16 alt2"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p class="note"><strong>Note:</strong> by default objects receive <code>Object.prototype</code> as their inheritance object.</p>
<p>Any object can be used as a prototype of another object, and the prototype itself can have its own prototype. If a prototype has a non-null reference to its prototype, and so on, it is called the <em>prototype chain</em>.</p>
<p class="definition">
  <b>Def. 3: Prototype chain:</b> A <em>prototype chain</em> is a <em>finite</em> chain of objects used to implement <em>inheritance</em> and <em>shared properties</em>.
</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/prototype-chain.png" width="600" alt="Figure 2. A prototype chain." title="Figure 2. A prototype chain."></p>
<p class="figure">Figure 2. A prototype chain.</p>
<p>The rule is very simple: if a property is not found in the object itself, there is an attempt to <em>resolve</em> it in the prototype; in the prototype of the prototype, etc. — until the whole prototype chain is considered.</p>
<p>Technically this mechanism is known as <em>dynamic dispatch</em> or <em>delegation</em>.</p>
<p class="definition">
  <b>Def. 4: Delegation:</b> a mechanism used to resolve a property in the inheritance chain. The process happens at runtime, hence is also called <strong><em>dynamic dispatch</em></strong>.
</p>
<p class="note"><strong>Note:</strong> in contrast with <em>static dispatch</em> when references are resolved at <em>compile time</em>, <em>dynamic dispatch</em> resolves the references at <em>runtime</em>.</p>
<p>And if a property eventually is not found in the prototype chain, the <code>undefined</code> value is returned:</p>
<div><div id="highlighter_839884" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// An "empty" object.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">empty = {};</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript plain">console.log(</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// function, from default prototype</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">empty.toString,</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// undefined</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">empty.x,</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>As we can see, a default object is actually <em>never empty</em> — it always inherits <em>something</em> from the <code>Object.prototype</code>. To create a <em>prototype-less dictionary</em>, we have to explicitly set its prototype to <code>null</code>:</p>
<div><div id="highlighter_777554" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Doesn't inherit from anything.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">dict = Object.create(</code><code class="jscript keyword">null</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript plain">console.log(dict.toString); </code><code class="jscript comments">// undefined</code></div></div></td></tr></tbody></table></div></div>
<p>The <em>dynamic dispatch</em> mechanism allows <em>full mutability</em> of the inheritance chain, providing an ability to change the delegation object:</p>
<div><div id="highlighter_718233" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">protoA = {x: 10};</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">protoB = {x: 20};</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript comments">// Same as `let objectC = {__proto__: protoA};`:</code></div><div class="line number5 index4 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">objectC = Object.create(protoA);</code></div><div class="line number6 index5 alt1"><code class="jscript plain">console.log(objectC.x); </code><code class="jscript comments">// 10</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript comments">// Change the delegate:</code></div><div class="line number9 index8 alt2"><code class="jscript plain">Object.setPrototypeOf(objectC, protoB);</code></div><div class="line number10 index9 alt1"><code class="jscript plain">console.log(objectC.x); </code><code class="jscript comments">// 20</code></div></div></td></tr></tbody></table></div></div>
<p class="note"><strong>Note:</strong> even though the <code>__proto__</code> property is standardized today, and is easier to use for explanations, on practice prefer using API methods for prototype manipulations, such as <code>Object.create</code>, <code>Object.getPrototypeOf</code>,<br>
 <code>Object.setPrototypeOf</code>, and similar on the <code>Reflect</code> module.</p>
<p>On the example of <code>Object.prototype</code>, we see that the <em>same prototype</em> can be shared across <em>multiple objects</em>. On this principle the <em>class-based inheritance</em> is implemented in ECMAScript. Let’s see the example, and look under the hood of the “class” abstraction in JS.</p>
<h2 id="class" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#class">Class</a></h2>
<p>When several objects share the same initial state and behavior, they form a <em>classification</em>.</p>
<p class="definition">
  <b>Def. 5: Class:</b> A <em>class</em> is a formal abstract set which specifies initial state and behavior of its objects.
</p>
<p>In case we need to have <em>multiple objects</em> inheriting from the same prototype, we could of course create this one prototype, and explicitly inherit it from the newly created objects:</p>
<div><div id="highlighter_328410" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Generic prototype for all letters.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">letter = {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">getNumber() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.number;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number6 index5 alt1"><code class="jscript plain">};</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">a = {number: 1, __proto__: letter};</code></div><div class="line number9 index8 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">b = {number: 2, __proto__: letter};</code></div><div class="line number10 index9 alt1"><code class="jscript comments">// ...</code></div><div class="line number11 index10 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">z = {number: 26, __proto__: letter};</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript plain">console.log(</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">a.getNumber(), </code><code class="jscript comments">// 1</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">b.getNumber(), </code><code class="jscript comments">// 2</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">z.getNumber(), </code><code class="jscript comments">// 26</code></div><div class="line number17 index16 alt2"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>We can see these relationships on the following figure:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shared-prototype.png" width="500" alt="Figure 3. A shared prototype." title="Figure 3. A shared prototype."></p>
<p class="figure">Figure 3. A shared prototype.</p>
<p>However, this is obviously <em>cumbersome</em>. And the class abstraction serves exactly this purpose — being a <em>syntactic sugar</em> (i.e. a construct which <em>semantically does the same</em>, but in a much <em>nicer syntactic form</em>), it allows creating such multiple objects with the convenient pattern:</p>
<div><div id="highlighter_165368" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">class</code> <code class="jscript plain">Letter {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">constructor(number) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.number = number;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">getNumber() {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.number;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number9 index8 alt2"><code class="jscript plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">a = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(1);</code></div><div class="line number12 index11 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">b = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(2);</code></div><div class="line number13 index12 alt2"><code class="jscript comments">// ...</code></div><div class="line number14 index13 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">z = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(26);</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="jscript plain">console.log(</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">a.getNumber(), </code><code class="jscript comments">// 1</code></div><div class="line number18 index17 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">b.getNumber(), </code><code class="jscript comments">// 2</code></div><div class="line number19 index18 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">z.getNumber(), </code><code class="jscript comments">// 26</code></div><div class="line number20 index19 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p class="note"><strong>Note:</strong> <em>class-based inheritance</em> in ECMAScript is implemented on top of the <em>prototype-based delegation</em>.</p>
<p class="note"><strong>Note:</strong> a <em>“class”</em> is just a <em>theoretical abstraction</em>. Technically it can be implemented with the <em>static dispatch</em> as in Java or C++, or <em>dynamic dispatch (delegation)</em> as in JavaScript, Python, Ruby, etc.</p>
<p>Technically a “class” is represented as a <em>“constructor function + prototype”</em> pair. Thus, a constructor function <em>creates objects</em>, and also <em>automatically</em> sets the <em>prototype</em> for its newly created instances. This prototype is stored in the <code>&lt;ConstructorFunction&gt;.prototype</code> property. </p>
<p class="definition">
  <b>Def. 6: Constructor:</b> A <em>constructor</em> is a function which is used to create instances, and automatically set their prototype.
</p>
<p>It is possible to use a constructor function explicitly. Moreover, before the class abstraction was introduced, JS developers used to do so not having a better alternative (we can still find a lot of such legacy code allover the internets):</p>
<div><div id="highlighter_932050" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">Letter(number) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.number = number;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">Letter.prototype.getNumber = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.number;</code></div><div class="line number7 index6 alt2"><code class="jscript plain">};</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">a = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(1);</code></div><div class="line number10 index9 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">b = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(2);</code></div><div class="line number11 index10 alt2"><code class="jscript comments">// ...</code></div><div class="line number12 index11 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">z = </code><code class="jscript keyword">new</code> <code class="jscript plain">Letter(26);</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="jscript plain">console.log(</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">a.getNumber(), </code><code class="jscript comments">// 1</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">b.getNumber(), </code><code class="jscript comments">// 2</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">z.getNumber(), </code><code class="jscript comments">// 26</code></div><div class="line number18 index17 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>And while creating a single-level constructor was pretty easy, the inheritance pattern from parent classes required much more boilerplate. Currently this boilerplate is hidden as an <em>implementation detail</em>, and that exactly what happens under the hood when we create a class in JavaScript.</p>
<p class="note"><strong>Note:</strong> <em>constructor functions</em> are just <em>implementation details</em> of the class-based inheritance.</p>
<p>Let’s see the relationships of the objects and their class:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/js-constructor.png" alt="Figure 4. A constructor and objects relationship." title="Figure 4. A constructor and objects relationship."></p>
<p class="figure">Figure 4. A constructor and objects relationship.</p>
<p>The figure above shows that <em>every object</em> has an associated prototype. Even the constructor function (class) <code>Letter</code> has its own prototype, which is <code>Function.prototype</code>. Notice, that <code>Letter.prototype</code> is the prototype of the Letter <em>instances</em>, that is <code>a</code>, <code>b</code>, and <code>z</code>.</p>
<p class="note"><strong>Note:</strong> the <em>actual</em> prototype of <em>any</em> object is <em>always</em> the <code>__proto__</code> reference. And the explicit <code>prototype</code> property on the constructor function is just a reference to the prototype of its <em>instances</em>; from instances it’s still referred by the <code>__proto__</code>. See details <a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-2-oop-ecmascript-implementation/#explicit-codeprototypecode-and-implicit-codeprototypecode-properties">here</a>.</p>
<p>You can find a detailed discussion on generic OPP concepts (including detailed descriptions of the class-based, prototype-based, etc) in the <a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-1-oop-general-theory/">ES3. 7.1 OOP: The general theory</a> article.</p>
<p>Now when we understand the basic relationships between ECMAScript objects, let’s take a deeper look at JS <em>runtime system</em>. As we will see, almost everything there can also be presented as an object.</p>
<h2 id="execution-context" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#execution-context">Execution context</a></h2>
<p>To execute JS code and track its runtime evaluation, ECMAScript spec defines the concept of an <em>execution context</em>. Logically execution contexts are maintained using a <em>stack</em> (the <em>execution context stack</em> as we will see shortly), which corresponds to the generic concept of a <em>call-stack</em>.</p>
<p class="definition">
  <b>Def. 7: Execution context:</b> An <em>execution context</em> is a specification device that is used to track the runtime evaluation of the code.
</p>
<p>There are several types of ECMAScript code: the <em>global code</em>, <em>function code</em>, <em><code>eval</code> code</em>, and <em>module code</em>; each code is evaluated in its execution context. Different code types, and their appropriate objects may affect the structure of an execution context: for example, <em>generator functions</em> save their <em>generator object</em> on the context.</p>
<p>Let’s consider a recursive function call:</p>
<div><div id="highlighter_297970" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">recursive(flag) {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Exit condition.</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain">(flag === 2) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code><code class="jscript plain">;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Call recursively.</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">recursive(++flag);</code></div><div class="line number10 index9 alt1"><code class="jscript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript comments">// Go.</code></div><div class="line number13 index12 alt2"><code class="jscript plain">recursive(0);</code></div></div></td></tr></tbody></table></div></div>
<p>When a function is called, a <em>new execution context</em> is created, and <em>pushed</em> onto the stack — at this point it becomes <em>an active execution context</em>. When a function returns, its context is <em>popped</em> from the stack.</p>
<p>A context which calls another context is called a <em>caller</em>. And a context which is being called, accordingly, is a <em>callee</em>. In our example the <code>recursive</code> function plays both roles: of a callee and a caller — when calls itself recursively.</p>
<p class="definition">
  <b>Def. 8: Execution context stack:</b> An <em>execution context stack</em> is a LIFO structure used to maintain control flow and order of execution.
</p>
<p>For our example from above we have the following stack <em>“push-pop”</em> modifications:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/execution-stack.png" alt="Figure 5. An execution context stack." title="Figure 5. An execution context stack."></p>
<p class="figure">Figure 5. An execution context stack.</p>
<p>As we can also see, the <em>global context</em> is always at the bottom of the stack, it is created prior execution of any other context.</p>
<p>You can find more details on execution contexts in the <a href="http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/">appropriate chapter</a>.</p>
<p>In general, the code of a context <em>runs to completion</em>, however as we mentioned above, some objects — such as <em>generators</em>, may violate LIFO order of the stack. A generator function may suspend its running context, and <em>remove</em> it from the stack <em>before completion</em>. Once a generator is activated again, its context is <em>resumed</em> and again is <em>pushed</em> onto the stack:</p>
<div><div id="highlighter_878408" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">*gen() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">yield</code> <code class="jscript plain">1;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">2;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">g = gen();</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript plain">console.log(</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">g.next().value, </code><code class="jscript comments">// 1</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">g.next().value, </code><code class="jscript comments">// 2</code></div><div class="line number11 index10 alt2"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>The <code>yield</code> statement here returns the value to the caller, and pops the context. On the second <code>next</code> call, the <em>same context</em> is pushed again onto the stack, and is <em>resumed</em>. Such context may <em>outlive</em> the caller which creates it, hence the violation of the LIFO structure.</p>
<p class="note"><strong>Note:</strong> you can read more about generators and iterators in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">this documentation</a>.</p>
<p>We shall now discuss the important components of an execution context; in particular we should see how ECMAScript runtime manages <em>variables storage</em>, and <em>scopes</em> created by nested blocks of a code. This is the generic concept of <em>lexical environments</em>, which is used in JS to store data, and solve the <em>“Funarg problem”</em> — with the mechanism of <em>closures</em>.</p>
<h2 id="environment" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#environment">Environment</a></h2>
<p>Every execution context has an associated <em>lexical environment</em>.</p>
<p class="definition">
  <b>Def. 9: Lexical environment:</b> A <em>lexical environment</em> is a structure used to define association between <em>identifiers</em> appearing in the context with their values. Each environment can have a reference to an <em>optional parent environment</em>.
</p>
<p>So an environment is a <em>storage</em> of variables, functions, and classes defined in a scope.</p>
<p>Technically, an environment is a <em>pair</em>, consisting of an <em>environment record</em> (an actual storage table which maps identifiers to values), and a reference to the parent (which can be <code>null</code>).</p>
<p>For the code:</p>
<div><div id="highlighter_781130" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">x = 10;</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">y = 20;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">foo(z) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">x = 100;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x + y + z;</code></div><div class="line number7 index6 alt2"><code class="jscript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript plain">foo(30); </code><code class="jscript comments">// 150</code></div></div></td></tr></tbody></table></div></div>
<p>The environment structures of the <em>global context</em>, and a context of the <code>foo</code> function would look as follows:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/environment-chain.png" width="400" alt="Figure 6. An environment chain." title="Figure 6. An environment chain."></p>
<p class="figure">Figure 6. An environment chain.</p>
<p>Logically this reminds us of the <em>prototype chain</em> which we’ve discussed above. And the rule for <em>identifiers resolution</em> is very similar: if a variable is <em>not found</em> in the <em>own</em> environment, there is an attempt to lookup it in the <em>parent environment</em>, in the parent of the parent, and so on — until the whole <em>environment chain</em> is considered.</p>
<p class="definition">
  <b>Def. 10: Identifier resolution:</b> the process of resolving a variable <em>(binding)</em> in an environment chain. An unresolved binding results to <code>ReferenceError</code>.
</p>
<p>This explains why variable <code>x</code> is resolved to <code>100</code>, but not to <code>10</code> — it is found directly in the <em>own</em> environment of <code>foo</code>; why we can access parameter <code>z</code> — it’s also just stored on the <em>activation environment</em>; and also why we can access the variable <code>y</code> — it is found in the parent environment.</p>
<p>Similarly to prototypes, the same parent environment can be shared by several child environments: for example, two global functions share the same global environment.</p>
<p class="note"><strong>Note:</strong> you can get detailed information about lexical environment in <a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-2-lexical-environments-ecmascript-implementation/">this article</a>.</p>
<p>Environment records differ by <em>type</em>. There are <strong><em>object</em></strong> environment records and <strong><em>declarative</em></strong> environment records. On top of the declarative record there are also <strong><em>function</em></strong> environment records, and <strong><em>module</em></strong> environment records. Each type of the record has specific only to it properties. However, the generic mechanism of the identifier resolution is common across all the environments, and doesn’t depend on the type of a record.</p>
<p>An example of an <em>object environment record</em> can be the record of the <em>global environment</em>. Such record has also associated <em>binding object</em>, which may store some properties from the record, but not the others, and vice-versa. The binding object can also be provided as <code>this</code> value.</p>
<div><div id="highlighter_862341" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Legacy variables using `var`.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">x = 10;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript comments">// Modern variables using `let`.</code></div><div class="line number5 index4 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">y = 20;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript comments">// Both are added to the environment record:</code></div><div class="line number8 index7 alt1"><code class="jscript plain">console.log(</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">x, </code><code class="jscript comments">// 10</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">y, </code><code class="jscript comments">// 20</code></div><div class="line number11 index10 alt2"><code class="jscript plain">);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript comments">// But only `x` is added to the "binding object".</code></div><div class="line number14 index13 alt1"><code class="jscript comments">// The binding object of the global environment</code></div><div class="line number15 index14 alt2"><code class="jscript comments">// is the global object, and equals to `this`:</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="jscript plain">console.log(</code></div><div class="line number18 index17 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.x, </code><code class="jscript comments">// 10</code></div><div class="line number19 index18 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.y, </code><code class="jscript comments">// undefined!</code></div><div class="line number20 index19 alt1"><code class="jscript plain">);</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="jscript comments">// Binding object can store a name which is not</code></div><div class="line number23 index22 alt2"><code class="jscript comments">// added to the environment record, since it's</code></div><div class="line number24 index23 alt1"><code class="jscript comments">// not a valid identifier:</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="jscript keyword">this</code><code class="jscript plain">['not valid ID</code><code class="jscript string">'] = 30;</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="jscript string">console.log(</code></div><div class="line number29 index28 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript string">this['</code><code class="jscript plain">not valid ID'], </code><code class="jscript comments">// 30</code></div><div class="line number30 index29 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>This is depicted on the following figure:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/env-binding-object.png" width="500" alt="Figure 7. A binding object." title="Figure 7. A binding object."></p>
<p class="figure">Figure 7. A binding object.</p>
<p>Notice, the binding object exists to cover <em>legacy constructs</em> such as <code>var</code>-declarations, and <code>with</code>-statements, which also provide their object as a binding object. These are historical reason when environments were represented as simple objects. Currently the environments model is much more optimized, however as a result we can’t access binding as properties anymore.</p>
<p>We have already seen how environments are related via the parent link. Now we shall see how an environment can <em>outlive</em> the context which creates it. This is the basis for the mechanism of <em>closures</em> which we’re about to discuss.</p>
<h2 id="closure" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#closure">Closure</a></h2>
<p>Functions in ECMAScript are <em>first-class</em>. This concept is fundamental to <em>functional programming</em>, which aspects are supported in JavaScript.</p>
<p class="definition">
  <b>Def. 11: First-class function:</b> a function which can participate as a normal data: be stored in a variable, passed as an argument, or returned as a value from another function.
</p>
<p>With the concept of first-class functions so called <a href="https://en.wikipedia.org/wiki/Funarg_problem">“Funarg problem”</a> is related  (or <em>“A problem of a functional argument”</em>). The problem arises when a function has to deal with <em>free variables</em>.</p>
<p class="definition">
  <b>Def. 12: Free variable:</b> a variable which is <em>neither a parameter</em>, <em>nor a local variable</em> of this function.
</p>
<p>Let’s take a look at the Funarg problem, and see how it’s solved in ECMAScript.</p>
<p>Consider the following code snippet:</p>
<div><div id="highlighter_728188" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">x = 10;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">console.log(x);</code></div><div class="line number5 index4 alt2"><code class="jscript plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">bar(funArg) {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">x = 20;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">funArg(); </code><code class="jscript comments">// 10, not 20!</code></div><div class="line number10 index9 alt1"><code class="jscript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript comments">// Pass `foo` as an argument to `bar`.</code></div><div class="line number13 index12 alt2"><code class="jscript plain">bar(foo);</code></div></div></td></tr></tbody></table></div></div>
<p>For the function <code>foo</code> the variable <code>x</code> is free. When the <code>foo</code> function is activated (via the <code>funArg</code> parameter) — where should it resolve the <code>x</code> binding? From the <em>outer scope</em> where the function was <em>created</em>, or from the <em>caller scope</em>, from where the function is <em>called</em>? As we see, the caller, that is the <code>bar</code> function, also provides the binding for <code>x</code> — with the value <code>20</code>. </p>
<p>The use-case described above is known as the <strong><em>downwards funarg problem</em></strong>, i.e. an <em>ambiguity</em> at determining a <em>correct environment</em> of a binding: should it be an environment of the <em>creation time</em>, or environment of the <em>call time</em>?</p>
<p>This is solved by an agreement of using <em>static scope</em>, that is the scope of the <em>creation time</em>.</p>
<p class="definition">
  <b>Def. 13: Static scope:</b> a language implements <em>static scope</em>, if only by looking at the source code one can determine in which environment a binding is resolved.</p>
<p>The static scope sometimes is also called <em>lexical scope</em>, hence the <em>lexical environments</em> naming.</p>
<p>Technically the static scope is implemented by <em>capturing the environment</em> where a function is <em>created</em>.</p>
<p class="note"><strong>Note:</strong> you can read about <em>static</em> and <em>dynamic</em> scopes in <a href="https://codeburst.io/js-scope-static-dynamic-and-runtime-augmented-5abfee6223fe">this article</a>.</p>
<p>In our example, the environment captured by the <code>foo</code> function, is the <em>global environment</em>:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/closure.png" width="400" alt="Figure 8. A closure." title="Figure 8. A closure."></p>
<p class="figure">Figure 8. A closure.</p>
<p>We can see that an environment references a function, which in turn reference the environment <em>back</em>.</p>
<p class="definition">
  <b>Def. 14: Closure:</b> A <em>closure</em> is a function which <em>captures the environment</em> where it’s <em>defined</em>. Further this environment is used for <em>identifier resolution</em>.</p>
<p class="note"><strong>Note:</strong> a function is <em>called</em> in a <em>fresh activation environment</em> which stores <em>local variables</em>, and <em>arguments</em>. The <em>parent environment</em> of the activation environment is set to the <em>closured environment</em> of the function, resulting to the <em>lexical scope</em> semantics.</p>
<p>The second sub-type of the Funarg problem is known as the <strong><em>upwards funarg problem</em></strong>. The only difference here is that a capturing environment <em>outlives</em> the context which creates it.</p>
<p>Let’s see the example:</p>
<div><div id="highlighter_755554" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">x = 10;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code>&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Closure, capturing environment of `foo`.</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Upward funarg.</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar;</code></div><div class="line number11 index10 alt2"><code class="jscript plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">x = 20;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="jscript comments">// Call to `foo` returns `bar` closure.</code></div><div class="line number16 index15 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">bar = foo();</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="jscript plain">bar(); </code><code class="jscript comments">// 10, not 20!</code></div></div></td></tr></tbody></table></div></div>
<p>Again, technically it doesn’t differ from the same exact mechanism of capturing the definition environment. Just in this case, hadn’t we have the closure, the activation environment of <code>foo</code> <em>would be destroyed</em>. But we <em>captured</em> it, so it <em>cannot be deallocated</em>, and is preserved — to support <em>static scope</em> semantics.</p>
<p>Often there is an incomplete understanding of closures — usually developers think about closures only in terms of the upward funarg problem (and practically it really makes more sense). However, as we can see, the technical mechanism for the <em>downwards</em> and <em>upwards funarg problem</em> is <em>exactly the same</em> — and is the <em>mechanism of the static scope</em>.</p>
<p>As we mentioned above, similarly to prototypes, the same parent environment can be <em>shared</em> across <em>several</em> closures. This allows accessing and mutating the shared data:</p>
<div><div id="highlighter_932532" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">createCounter() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">count = 0;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">{</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">increment() { count++; </code><code class="jscript keyword">return</code> <code class="jscript plain">count; },</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">decrement() { count--; </code><code class="jscript keyword">return</code> <code class="jscript plain">count; },</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number8 index7 alt1"><code class="jscript plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">counter = createCounter();</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">console.log(</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">counter.increment(), </code><code class="jscript comments">// 1</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">counter.decrement(), </code><code class="jscript comments">// 0</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">counter.increment(), </code><code class="jscript comments">// 1</code></div><div class="line number16 index15 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>Since both closures, <code>increment</code> and <code>decrement</code>, are created within the scope containing the <code>count</code> variable, they <em>share</em> this <em>parent scope</em>. That is, capturing always happens <em>“by-reference”</em> — meaning the <em>reference</em> to the <em>whole parent environment</em> is stored.</p>
<p>We can see this on the following picture:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shared-environment.png" width="600" alt="Figure 9. A closure." title="Figure 9. A shared environment."></p>
<p class="figure">Figure 9. A shared environment.</p>
<p>Some languages may capture <em>by-value</em>, making a copy of a captured variable, and do not allow changing it in the parent scopes. However in JS, to repeat, it is always the <em>reference</em> to the parent scope.</p>
<p class="note"><strong>Note:</strong> implementations may optimize this step, and do not capture the whole environment. Capturing <em>only used</em> free-variables, they though still maintain invariant of mutable data in parent scopes.</p>
<p>You can find a detailed discussion on closures and the Funarg problem in the <a href="http://dmitrysoshnikov.com/ecmascript/chapter-6-closures/">appropriate chapter</a>.</p>
<p>So all identifiers are statically scoped. There is however <em>one</em> value which is <em>dynamically scoped</em> in ECMAScript. It’s the value of <code>this</code>.</p>
<h2 id="this" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#this">This</a></h2>
<p>The <code>this</code> value is a special object which is <em>dynamically</em> and <em>implicitly</em> passed to the code of a context. We can consider it as an <em>implicit extra parameter</em>, which we can access, but cannot mutate.</p>
<p>The purpose of the <code>this</code> value is to executed the same code for multiple objects.</p>
<p class="definition">
  <b>Def. 15: This:</b> an implicit <em>context object</em> accessible from a code of an execution context — in order to apply the same code for multiple objects.</p>
<p>The major use-case is the class-based OOP. An instance method (which is defined on the prototype) exists in <em>one exemplar</em>, but is <em>shared</em> across <em>all the instances</em> of this class.</p>
<div><div id="highlighter_121501" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">class</code> <code class="jscript plain">Point {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">constructor(x, y) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">._x = x;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">._y = y;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">getX() {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">._x;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">getY() {</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">._y;</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number14 index13 alt1"><code class="jscript plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">p1 = </code><code class="jscript keyword">new</code> <code class="jscript plain">Point(1, 2);</code></div><div class="line number17 index16 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">p2 = </code><code class="jscript keyword">new</code> <code class="jscript plain">Point(3, 4);</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="jscript comments">// Can access `getX`, and `getY` from</code></div><div class="line number20 index19 alt1"><code class="jscript comments">// both instances (they are passed as `this`).</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="jscript plain">console.log(</code></div><div class="line number23 index22 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">p1.getX(), </code><code class="jscript comments">// 1</code></div><div class="line number24 index23 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">p2.getX(), </code><code class="jscript comments">// 3</code></div><div class="line number25 index24 alt2"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>When the <code>getX</code> method is activated, a new environment is created to store local variables and parameters. In addition, <em>function environment record</em> gets the <code>[[ThisValue]]</code> passed, which is bound <em>dynamically</em> depending how a function is <em>called</em>. When it’s called with <code>p1</code>, the <code>this</code> value is exactly <code>p1</code>, and in the second case it’s <code>p2</code>.</p>
<p>Another application of <code>this</code>, is <em>generic interface functions</em>, which can be used in <em>mixins</em> or <em>traits</em>.</p>
<p>In the following example, the <code>Movable</code> interface contains generic function <code>move</code>, which expects the users of this mixin to implement <code>_x</code>, and <code>_y</code> properties:</p>
<div><div id="highlighter_843656" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Generic Movable interface (mixin).</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">Movable = {</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">/**</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">* This function is generic, and works with any</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">* object, which provides `_x`, and `_y` properties,</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">* regardless of the class of this object.</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">*/</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">move(x, y) {</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">._x = x;</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">._y = y;</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number13 index12 alt2"><code class="jscript plain">};</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">p1 = </code><code class="jscript keyword">new</code> <code class="jscript plain">Point(1, 2);</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="jscript comments">// Make `p1` movable.</code></div><div class="line number18 index17 alt1"><code class="jscript plain">Object.assign(p1, Movable);</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="jscript comments">// Can access `move` method.</code></div><div class="line number21 index20 alt2"><code class="jscript plain">p1.move(100, 200);</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="jscript plain">console.log(p1.getX()); </code><code class="jscript comments">// 100</code></div></div></td></tr></tbody></table></div></div>
<p>As an alternative, a mixin can also be applied at <em>prototype level</em> instead of <em>per-instance</em> as we did in the example above.</p>
<p>Just to show the dynamic nature of <code>this</code> value, consider this example, which we leave to a reader as an exercise to solve:</p>
<div><div id="highlighter_569736" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">bar = {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">foo,</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">baz() {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number11 index10 alt2"><code class="jscript plain">};</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript comments">// `foo`</code></div><div class="line number14 index13 alt1"><code class="jscript plain">console.log(</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">foo(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript comments">// global or undefined</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">bar.foo(),&nbsp;&nbsp; </code><code class="jscript comments">// bar</code></div><div class="line number18 index17 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">(bar.foo)(), </code><code class="jscript comments">// bar</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">(bar.foo = bar.foo)(), </code><code class="jscript comments">// global</code></div><div class="line number21 index20 alt2"><code class="jscript plain">);</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="jscript comments">// `bar.baz`</code></div><div class="line number24 index23 alt1"><code class="jscript plain">console.log(bar.baz()); </code><code class="jscript comments">// bar</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">savedBaz = bar.baz;</code></div><div class="line number27 index26 alt2"><code class="jscript plain">console.log(savedBaz()); </code><code class="jscript comments">// global</code></div></div></td></tr></tbody></table></div></div>
<p>Since only by looking at the source code of the <code>foo</code> function we <em>cannot tell</em> what value of <code>this</code> will it have <em>in a particular call</em>, we say that <code>this</code> value is <em>dynamically scoped</em>.</p>
<p class="note"><strong>Note:</strong> you can get a detailed explanation how <code>this</code> value is determined, and why the code from above works the way it does, in the <a href="http://dmitrysoshnikov.com/ecmascript/chapter-3-this/">appropriate chapter</a>.</p>
<p>The <strong><em>arrow functions</em></strong> are special in terms of <code>this</code> value: their <code>this</code> is <em>lexical (static)</em>, but <em>not dynamic</em>. I.e. their function environment record <em>does not provide <code>this</code> value</em>, and it’s taken from the <em>parent environment</em>.</p>
<div><div id="highlighter_278876" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">x = 10;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">foo = {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">x: 20,</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Dynamic `this`.</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">bar() {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.x;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Lexical `this`.</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">baz: () =&gt; </code><code class="jscript keyword">this</code><code class="jscript plain">.x,</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">qux() {</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// Lexical this within the invocation.</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">arrow = () =&gt; </code><code class="jscript keyword">this</code><code class="jscript plain">.x;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">arrow();</code></div><div class="line number19 index18 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number20 index19 alt1"><code class="jscript plain">};</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="jscript plain">console.log(</code></div><div class="line number23 index22 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">foo.bar(), </code><code class="jscript comments">// 20, from `foo`</code></div><div class="line number24 index23 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">foo.baz(), </code><code class="jscript comments">// 10, from global</code></div><div class="line number25 index24 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">foo.qux(), </code><code class="jscript comments">// 20, from `foo` and arrow</code></div><div class="line number26 index25 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>Like we said, in the <em>global context</em> the <code>this</code> value is the <em>global object</em> (the <em>binding object</em> of the <em>global environment record</em>). Previously there was only one global object. In current version of the spec there might be <em>multiple global objects</em> which are part of <em>code realms</em>. Let’s discuss this structure.</p>
<h2 id="realm" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#realm">Realm</a></h2>
<p>Before it is evaluated, all ECMAScript code must be associated with a <em>realm</em>. Technically a realm just provides a global environment for a context.</p>
<p class="definition">
  <b>Def. 16: Realm:</b> A <em>code realm</em> is an object which encapsulates a separate <em>global environment</em>.</p>
<p>When an <em>execution context</em> is <em>created</em> it’s <em>associated</em> with a particular <em>code realm</em>, which provides the <em>global environment</em> for this context. This association further <em>stays unchanged</em>.</p>
<p class="note"><strong>Note:</strong> a direct realm equivalent in browser environment is the <code>iframe</code> element, which exactly provides a custom global environment. In Node.js it is close to the sandbox of the <a href="https://nodejs.org/api/vm.html">vm module</a>.</p>
<p>Current version of the specification doesn’t provide an ability to explicitly create realms, but they can be created implicitly by the implementations. There is a <a href="https://github.com/tc39/proposal-realms/">proposal</a> though to expose this API to user-code.</p>
<p>Logically though, each context from the stack is always associated with its realm:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/context-realm.png" width="400" alt="Figure 10. A context and realm association." title="Figure 10. A context and realm association."></p>
<p class="figure">Figure 10. A context and realm association.</p>
<p>Let’s see the separate realms example, using the <code>vm</code> module:</p>
<div><div id="highlighter_527988" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">const vm = require(</code><code class="jscript string">'vm'</code><code class="jscript plain">);</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript comments">// First realm, and its global:</code></div><div class="line number4 index3 alt1"><code class="jscript plain">const realm1 = vm.createContext({x: 10, console});</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript comments">// Second realm, and its global:</code></div><div class="line number7 index6 alt2"><code class="jscript plain">const realm2 = vm.createContext({x: 20, console});</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript comments">// Code to execute:</code></div><div class="line number10 index9 alt1"><code class="jscript plain">const code = `console.log(x);`;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">vm.runInContext(code, realm1); </code><code class="jscript comments">// 10</code></div><div class="line number13 index12 alt2"><code class="jscript plain">vm.runInContext(code, realm2); </code><code class="jscript comments">// 20</code></div></div></td></tr></tbody></table></div></div>
<p>Now we’re getting closer to the bigger picture of the ECMAScript runtime. Yet however we still need to see the <em>entry point</em> to the code, and the <em>initialization process</em>. This is managed by the mechanism of <em>jobs</em> and <em>job queues</em>.</p>
<h2 id="job" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#job">Job</a></h2>
<p>Some operations can be postponed, and executed as soon as there is an available spot on the execution context stack.</p>
<p class="definition">
  <b>Def. 17: Job:</b> A <em>job</em> is an abstract operation that initiates an ECMAScript computation when <em>no other</em> ECMAScript computation is currently in progress.</p>
<p>Jobs are enqueued on the <strong><em>job queues</em></strong>, and in current spec version there are two job queues: <strong><em>ScriptJobs</em></strong>, and <strong><em>PromiseJobs</em></strong>.</p>
<p>And <em>initial job</em> on the <em>ScriptJobs</em> queue is the <em>main entry point</em> to our program — initial script which is loaded and evaluated: a realm is created, a global context is created and is associated with this realm, it’s pushed onto the stack, and the global code is executed.</p>
<p>Notice, the <em>ScriptJobs</em> queue manages both, <em>scripts</em> and <em>modules</em>.</p>
<p>Further this context can execute <em>other contexts</em>, or enqueue <em>other jobs</em>. An example of a job which can be spawned and enqueued is a <em>promise</em>.</p>
<p>When there is <em>no running</em> execution context and the execution context stack is <em>empty</em>, the ECMAScript implementation removes the first <em>pending job</em> from a job queue, creates an execution context and starts its execution.</p>
<p class="note"><strong>Note:</strong> the job queues are usually handled by the abstraction known as the <strong><em>“Event loop”</em></strong>. ECMAScript standard doesn’t specify the event loop, leaving it up to implementations, however you can find an educational example — <a href="https://gist.github.com/DmitrySoshnikov/26e54990e7df8c3ae7e6e149c87883e4">here</a>.</p>
<p>Example:</p>
<div><div id="highlighter_230239" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Enqueue a new promise on the PromiseJobs queue.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">new</code> <code class="jscript plain">Promise(resolve =&gt; setTimeout(() =&gt; resolve(10), 0))</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">.then(value =&gt; console.log(value));</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript comments">// This log is executed earlier, since it's still a</code></div><div class="line number6 index5 alt1"><code class="jscript comments">// running context, and job cannot start executing first</code></div><div class="line number7 index6 alt2"><code class="jscript plain">console.log(20);</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript comments">// Output: 20, 10</code></div></div></td></tr></tbody></table></div></div>
<p class="note"><strong>Note:</strong> you can read more about promises in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">this documentation</a>.</p>
<p>The <em><strong>async functions</strong></em> can <em>await</em> for promises, so they also enqueue promise jobs:</p>
<div><div id="highlighter_922803" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">async</code> <code class="jscript keyword">function</code> <code class="jscript plain">later() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">await</code> <code class="jscript plain">Promise.resolve(10);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">(</code><code class="jscript keyword">async</code> <code class="jscript plain">() =&gt; {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">data = </code><code class="jscript keyword">await</code> <code class="jscript plain">later();</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">console.log(data); </code><code class="jscript comments">// 10</code></div><div class="line number8 index7 alt1"><code class="jscript plain">})();</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript comments">// Also happens earlier, since async execution</code></div><div class="line number11 index10 alt2"><code class="jscript comments">// is queued on the PromiseJobs queue.</code></div><div class="line number12 index11 alt1"><code class="jscript plain">console.log(20);</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="jscript comments">// Output: 20, 10</code></div></div></td></tr></tbody></table></div></div>
<p class="note"><strong>Note:</strong> read more about async functions in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">here</a>.</p>
<p>Now we’re very close to the final picture of the current JS Universe. We shall see now <em>main owners</em> of all those components we discussed, the <em>Agents</em>.</p>
<h2 id="agent" class="header-link"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#agent">Agent</a></h2>
<p>The <em>concurrency</em> and <em>parallelism</em> is implemented in ECMAScript using <em>Agent pattern</em>. The Agent pattern is very close to the <a href="https://en.wikipedia.org/wiki/Actor_model">Actor pattern</a> — a <em>lightweight process</em> with <em>message-passing</em> style of communication.</p>
<p class="definition">
  <b>Def. 18: Agent:</b> An <em>agent</em> is an abstraction encapsulating execution context stack, set of job queues, and code realms.</p>
<p>Implementation dependent an agent can run on the same thread, or on a separate thread. The <code>Worker</code> agent in the browser environment is an example of the <em>Agent</em> concept.</p>
<p>The agents are <em>state isolated</em> from each other, and can communicate by <em>sending messages</em>. Some data can be shared though between agents, for example <code>SharedArrayBuffer</code>s. Agents can also combine into <em>agent clusters</em>. </p>
<p>In the example below, the <code>index.html</code> calls the <code>agent-smith.js</code> worker, passing shared chunk of memory:</p>
<div><div id="highlighter_906884" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// In the `index.html`:</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript comments">// Shared data between this agent, and another worker.</code></div><div class="line number4 index3 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">sharedHeap = </code><code class="jscript keyword">new</code> <code class="jscript plain">SharedArrayBuffer(16);</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript comments">// Our view of the data.</code></div><div class="line number7 index6 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">heapArray = </code><code class="jscript keyword">new</code> <code class="jscript plain">Int32Array(sharedHeap);</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript comments">// Create a new agent (worker).</code></div><div class="line number10 index9 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">agentSmith = </code><code class="jscript keyword">new</code> <code class="jscript plain">Worker(</code><code class="jscript string">'agent-smith.js'</code><code class="jscript plain">);</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">agentSmith.onmessage = (message) =&gt; {</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Agent sends the index of the data it modified.</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">modifiedIndex = message.data;</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Check the data is modified:</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">console.log(heapArray[modifiedIndex]); </code><code class="jscript comments">// 100</code></div><div class="line number18 index17 alt1"><code class="jscript plain">};</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="jscript comments">// Send the shared data to the agent.</code></div><div class="line number21 index20 alt2"><code class="jscript plain">agentSmith.postMessage(sharedHeap);</code></div></div></td></tr></tbody></table></div></div>
<p>And the worker code:</p>
<div><div id="highlighter_67961" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// agent-smith.js</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript comments">/**</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* Receive shared array buffer in this worker.</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">*/</code></div><div class="line number6 index5 alt1"><code class="jscript plain">onmessage = (message) =&gt; {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Worker's view of the shared data.</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">heapArray = </code><code class="jscript keyword">new</code> <code class="jscript plain">Int32Array(message.data);</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">indexToModify = 1;</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">heapArray[indexToModify] = 100;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Send the index as a message back.</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">postMessage(indexToModify);</code></div><div class="line number15 index14 alt2"><code class="jscript plain">};</code></div></div></td></tr></tbody></table></div></div>
<p>You can find the full code for the example above in <a href="https://gist.github.com/DmitrySoshnikov/b75a2dbcdb60b18fd9f05b595135dc82">this gist</a>.</p>
<p>(Notice, if you run this example locally, run it in Firefox, since Chrome due to security reasons doesn’t allow loading web workers from a local file)</p>
<p>So below is the picture of the ECMAScript runtime:</p>
<p><img class="aligncenter figure" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/agents-1.png" width="500" alt="Figure 11. ECMAScript runtime." title="Figure 11. ECMAScript runtime."></p>
<p class="figure">Figure 11. ECMAScript runtime.</p>
<p>And that is it; that’s what happens under the hood of the ECMAScript engine!</p>
<p>Now we come to an end. This is the amount of information on JS core which we can cover within an overview article. Like we mentioned, JS code can be grouped into <em>modules</em>, properties of objects can be tracked by <code>Proxy</code> objects, etc, etc. — there are many user-level details which you can find in different documentations on JavaScript language.</p>
<p>Here though we tried to represent the <em>logical structure</em> of an ECMAScript program itself, and hopefully it clarified these details. If you have any questions, suggestions or feedback, — as always I’ll be glad to discuss them in comments.</p>
<p>I’d like to thank the TC-39 representatives and spec editors which helped with clarifications for this article. The discussion can be found in <a href="https://twitter.com/DmitrySoshnikov/status/930507793047592960">this Twitter thread</a>. </p>
<p>Good luck in studying ECMAScript!</p>
<p><strong>Written by:</strong> Dmitry Soshnikov<br>
<strong>Published on:</strong> November 14th, 2017<br>

					</p></div>
	<!-- .entry-content -->

			<div class="post-author-bottom">
			<div class="post-author-card">
				<a class="site-logo" href="http://dmitrysoshnikov.com/">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c.jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100">				</a>

				<div class="post-author-info">
					<h1 class="site-title">
						<span class="byline"><span class="author vcard"><a class="url fn n" href="http://dmitrysoshnikov.com/" title="View all posts by Dmitry Soshnikov" rel="author">Dmitry Soshnikov</a></span></span>					</h1>

					<h2 class="site-description">Software engineer interested in learning and education. Sometimes blog on topics of programming languages theory, compilers, and ECMAScript.</h2>
				</div>
				<div class="post-published-date">
					<h2 class="site-published">Published</h2>
					<h2 class="site-published-date"><a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/" title="JavaScript. The Core: 2nd Edition" rel="bookmark"><time class="entry-date" datetime="2017-11-14T18:06:21+00:00" pubdate="pubdate">2017-11-14</time></a></h2>
										
					
				</div>
			</div>
		</div>
		<!-- .post-author-bottom -->
		
	<footer class="entry-meta">
		
					<div id="share-comment-button" style="display: block;">
				<button>
					<i class="share-comment-icon"></i>Write a Comment				</button>
			</div>
		
			</footer>
	<!-- .entry-meta -->

</article><!-- #post-3213 -->

				
	<div id="commentform-top" style="display: none;"></div> <!-- do not remove; used by jQuery to move the comment reply form here -->
		<div id="respond" class="comment-respond" style="display: none;">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/" style="display:none;">Cancel Reply</a></small></h3>			<form action="http://dmitrysoshnikov.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">
				<div id="main-reply-title"><h3>Write a Comment</h3></div><div class="comment-form-reply-title"><p>Comment</p></div><p class="comment-form-comment" id="comment-form-field"><textarea id="comment" name="comment" cols="60" rows="6" aria-required="true"></textarea></p><p class="comment-form-author"><label for="author">Name</label><input id="author" name="author" type="text" value="" aria-required="true"></p>
<p class="comment-form-email"><label for="email">Email</label><input id="email" name="email" type="text" value="" aria-required="true"></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value=""></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="3213" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f05e50d231"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1563682322921"></form>
			</div><!-- #respond -->
	

	<div id="comments" class="comments-area">
				
							<h2 class="comments-title">
					<i class="comments-title-icon"></i>
					45 Comments				</h2>
			
			
			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-208350">
		<article id="comment-208350" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/108c6e6fefac3ac25ab1e0d71d461b79.png" srcset="http://1.gravatar.com/avatar/108c6e6fefac3ac25ab1e0d71d461b79?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">James Levine</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208350">
						<time pubdate="" datetime="2017-11-15T21:35:32+00:00">
							2017-11-15						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>As always, fantastic and in-depth explanations of JavaScript internals. Thank you for your great job, Dmitry!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208356">
		<article id="comment-208356" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/e2bc6454684e2ad5160d435ff2272ad9.png" srcset="http://2.gravatar.com/avatar/e2bc6454684e2ad5160d435ff2272ad9?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Maksim Ryzhikov</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208356">
						<time pubdate="" datetime="2017-11-16T02:27:11+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Hi, Dmitry</p>
<p>Awesome work as usual! Thanks!</p>
<p>One note, here the error in the code:</p>
<div><div id="highlighter_962531" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">let</code> <code class="jscript plain">x = 10;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Closure, capturing environment of `foo`.</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x + y;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript comments">// Upward funarg.</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar;</code></div><div class="line number11 index10 alt2"><code class="jscript plain">}</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;</code>&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript keyword">let</code> <code class="jscript plain">x = 20;</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;</code>&nbsp;</div><div class="line number15 index14 alt2"><code class="jscript comments">// Call to `foo` returns `bar` closure.</code></div><div class="line number16 index15 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">bar = foo();</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="jscript plain">bar(); </code><code class="jscript comments">// 10, not 20!</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_680128" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Closure, capturing environment of `foo`.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x + y;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>should be</p>
<div><div id="highlighter_691669" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Closure, capturing environment of `foo`.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Thanks again!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208360">
		<article id="comment-208360" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/fa5dfcd76cfc8efd2386776df84e5927.jpeg" srcset="http://0.gravatar.com/avatar/fa5dfcd76cfc8efd2386776df84e5927?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Dzhavat</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208360">
						<time pubdate="" datetime="2017-11-16T05:16:09+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>I always enjoy it when I read something that deepens my understanding of JavaScript. Thank you for publishing this.</p>
<p>After going through Closures I noticed that the example under Def. 14 has a small error. It looks like the y variable, which is part of the foo function, is not defined. So running the code gives an error.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208369">
		<article id="comment-208369" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/e033fcb5b1de4541092f53dbb9aea179.jpeg" srcset="http://2.gravatar.com/avatar/e033fcb5b1de4541092f53dbb9aea179?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">alejandro</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208369">
						<time pubdate="" datetime="2017-11-16T10:22:21+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>good stuff, thanks!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208371">
		<article id="comment-208371" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208371">
						<time pubdate="" datetime="2017-11-16T10:39:05+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<b>James Levine</b>, thanks for the feedback! Glad to see more people interested in deeper JS.</p>
<p>@<b>Maksim Ryzhikov</b>, good catch, and thanks for the feedback! The copy-paste typo is fixed.</p>
<p>@<b>Dzhavat</b>, thanks, appreciated; the typo is fixed!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208372">
		<article id="comment-208372" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/fb09351ec2f786dff0dc0ff10be2f7e7.png" srcset="http://0.gravatar.com/avatar/fb09351ec2f786dff0dc0ff10be2f7e7?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Valeriy Podbeltsev</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208372">
						<time pubdate="" datetime="2017-11-16T10:46:59+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><blockquote><p>We can consider it as an <em>implicit extra parameter</em></p></blockquote>
<p>So that is why some languages like Python pass <code>this</code> explicitly, the <code>self</code> argument.</p>
<p>Thanks for the awesome explanations, Dmitry!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208373">
		<article id="comment-208373" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208373">
						<time pubdate="" datetime="2017-11-16T10:48:22+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Valeriy Podbeltsev</strong>, correct, and also e.g. Rust — also have to pass <code>self</code> explicitly. This just shows that <em>dynamic scope</em> can be <em>fully replaced</em> by <em>extra parameters</em>.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208374">
		<article id="comment-208374" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/e7db90efb063714c7f94380960d3035a.png" srcset="http://2.gravatar.com/avatar/e7db90efb063714c7f94380960d3035a?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">juan Barahona</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208374">
						<time pubdate="" datetime="2017-11-16T11:37:16+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>excelente explicación amigo!!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208375">
		<article id="comment-208375" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208375">
						<time pubdate="" datetime="2017-11-16T11:41:52+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>juan Barahona</strong>, gracias, amigo!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208376">
		<article id="comment-208376" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/9411323e860a1abb25edefcc5f635785.png" srcset="http://0.gravatar.com/avatar/9411323e860a1abb25edefcc5f635785?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Brian Jung</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208376">
						<time pubdate="" datetime="2017-11-16T12:05:21+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>This is the deepest explanation of  JavaScript I’ve ever seen! Thanks so much for this effort. Amazing material.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208387">
		<article id="comment-208387" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/9159bb71c2a5822fd1a0de9cab6efa12.png" srcset="http://0.gravatar.com/avatar/9159bb71c2a5822fd1a0de9cab6efa12?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Rock</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208387">
						<time pubdate="" datetime="2017-11-16T18:05:36+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Great job for the new ECMA description, thanks.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208389">
		<article id="comment-208389" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/49daf582ff48197db9d0087303be2c51.png" srcset="http://1.gravatar.com/avatar/49daf582ff48197db9d0087303be2c51?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Rick</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208389">
						<time pubdate="" datetime="2017-11-16T20:04:12+00:00">
							2017-11-16						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Great job! Thank you.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208399">
		<article id="comment-208399" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/78d8f8732fd6378224f8a2b53f78927b.png" srcset="http://1.gravatar.com/avatar/78d8f8732fd6378224f8a2b53f78927b?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">ehui</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208399">
						<time pubdate="" datetime="2017-11-17T05:39:43+00:00">
							2017-11-17						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Beau travail, Merci!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208406">
		<article id="comment-208406" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/2e3802d94db1e9288ab7afc809707709.png" srcset="http://2.gravatar.com/avatar/2e3802d94db1e9288ab7afc809707709?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Ramesh Thangamani</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208406">
						<time pubdate="" datetime="2017-11-17T08:54:02+00:00">
							2017-11-17						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><div><div id="highlighter_583633" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Doesn't inherit from anything.</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">let</code> <code class="jscript plain">dict = Object.create(</code><code class="jscript keyword">null</code><code class="jscript plain">); </code></div><div class="line number3 index2 alt2"><code class="jscript plain">console.log(dict.toString); </code><code class="jscript comments">// null</code></div></div></td></tr></tbody></table></div></div>
<p>The above code snippet displays “undefined” and not null ?</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208407">
		<article id="comment-208407" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208407">
						<time pubdate="" datetime="2017-11-17T10:38:37+00:00">
							2017-11-17						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<b>Brian Jung</b>, @<b>Rock</b>, @<b>Rick</b>, @<b>ehui</b>, thanks for the feedback guys, appreciated!</p>
<p>@<b>Ramesh Thangamani</b>, yep, thanks, typo is fixed (should be <code>undefined</code> of course as described in property resolution).</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208418">
		<article id="comment-208418" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/08ead3d4587b88e197d5df11e96da428.png" srcset="http://0.gravatar.com/avatar/08ead3d4587b88e197d5df11e96da428?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Alexander Pearson</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208418">
						<time pubdate="" datetime="2017-11-17T13:34:10+00:00">
							2017-11-17						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>The deepest explanation of closures I’ve seen! Going to the very roots of the functional programming and the Funarg problem. Congratulations, sir!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208423">
		<article id="comment-208423" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/2e3802d94db1e9288ab7afc809707709.png" srcset="http://2.gravatar.com/avatar/2e3802d94db1e9288ab7afc809707709?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Ramesh Thangamani</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208423">
						<time pubdate="" datetime="2017-11-17T23:06:31+00:00">
							2017-11-17						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Dimtry thanks a lot! for taking time and writing an excellent writeup. Learnt lot of stuff.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208545">
		<article id="comment-208545" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/626152127241bde3b12b41d04665a8d7.png" srcset="http://0.gravatar.com/avatar/626152127241bde3b12b41d04665a8d7?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Dmitriy</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208545">
						<time pubdate="" datetime="2017-11-22T05:08:06+00:00">
							2017-11-22						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Awesome article, helped me to recall a lot of things I could have forgotten. Also made me rethink some stuff. So thanks a lot! 🙂</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208546">
		<article id="comment-208546" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/82cc1e4dd4fe0c392059fef53666d4bc.jpeg" srcset="http://2.gravatar.com/avatar/82cc1e4dd4fe0c392059fef53666d4bc?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">artin</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208546">
						<time pubdate="" datetime="2017-11-22T05:11:46+00:00">
							2017-11-22						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Thanks for the article. You the best.</p>
<p>I have few questions, some of them not related directly to EcmaScript spec but rather to browser implementation details, sorry about that. Just trying to connect all pieces and see whole picture.</p>
<p>1. Is ‘microtask’ a valid term or we should use ‘job’?<br>
‘microtask’ was popularized by Jake Archibald`s article as opposed to browser’s ‘task’ / ‘task queue’, but looks like spec only knows ‘job’s</p>
<p>2. Is that correct that task queue (event loop) is not part of JS engine (implemeted separately by browser/nodejs/etc), while job queues are inside JS engine (eg. implemented directly by V8), or job queues implemented as environmental extension too?</p>
<p>3. What is the reason to split job queue into two parts (ScriptJobs, PromiseJobs)? Is there any difference in execution priority, like job from queue A should be executed before job from queue B if both are not empty, or something else?</p>
<p>4. AFAIK we have 2 sources of microtasks (jobs) now: Promise and MutationObserver. Does MutationObserver enqueues its jobs to PromiseJobs queue too, or there’s another queue in web engine for that?</p>
<p>5. Is that correct that main page and all child iframes (deep) share same task-queue/job-queues/execution-context-stack/thread, but execution contexts of functions from their scripts have different realms (ie. global environments)?</p>
<p>6. What is the purpose of ‘realm’ concept?<br>
Each EC is associated with realm, ok. Each realm holds reference to global env, ok. But each EC already has reference to chain of lexical envs, and last env in that chain – is global env. So identifier lookup down to global object already works without ‘realm’. How ‘realm’ is useful then?</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-208553">
		<article id="comment-208553" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208553">
						<time pubdate="" datetime="2017-11-22T15:09:49+00:00">
							2017-11-22						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>artin</strong>, thanks for the feedback, and a good set of questions!</p>
<blockquote><p>1. Is ‘microtask’ a valid term or we should use ‘job’?</p></blockquote>
<p>The ECMAScript spec doesn’t define any “microtask” concept (even though it might be the term of the DOM/HTML spec). Since JS can be used outside of the browser environment, the term “job” is correct relatively exactly JS language itself.</p>
<blockquote><p>2. Is that correct that task queue (event loop) is not part of JS engine (implemeted separately by browser/nodejs/etc), while job queues are inside JS engine (eg. implemented directly by V8), or job queues implemented as environmental extension too?</p></blockquote>
<p>Right, the ES spec doesn’t define the event loop, and leaves it up to an implementation (host environment). In addition, hosts may provide any other needed job queues (if browser environment choses to implement some “MicroTasksJobs” queue, it can do so).</p>
<blockquote><p>3. What is the reason to split job queue into two parts (ScriptJobs, PromiseJobs)? Is there any difference in execution priority, like job from queue A should be executed before job from queue B if both are not empty, or something else? </p></blockquote>
<p>The spec actually doesn’t define the order of serving the <em>implementation dependent</em> job queues, however, in the <a href="https://tc39.github.io/ecma262/#sec-runjobs" rel="nofollow">8.6 RunJobs</a>, other queues (including <code>PromiseJobs</code> queue) are served after <code>ScriptJobs</code>.</p>
<blockquote><p>4. AFAIK we have 2 sources of microtasks (jobs) now: Promise and MutationObserver. Does MutationObserver enqueues its jobs to PromiseJobs queue too, or there’s another queue in web engine for that?</p></blockquote>
<p>Unfortunately I’m not an expert of the DOM/HTML specifications, and can’t tell about <code>MutationObserver</code> queue, this is the specifics of the particular host.</p>
<blockquote><p>5. Is that correct that main page and all child iframes (deep) share same task-queue/job-queues/execution-context-stack/thread, but execution contexts of functions from their scripts have different realms (ie. global environments)?</p></blockquote>
<p>Yes, if this is per-agent, they are all shared, and each iframe provides just a new Realm (global environment). Though again, “iframe” terminology, etc relates to the HTML spec, not JS.</p>
<blockquote><p>6. What is the purpose of ‘realm’ concept?<br>
Each EC is associated with realm, ok. Each realm holds reference to global env, ok. But each EC already has reference to chain of lexical envs, and last env in that chain – is global env. So identifier lookup down to global object already works without ‘realm’. How ‘realm’ is useful then?</p></blockquote>
<p>In addition to the global environment, and global object, a realm also holds some internal state (like intrinsic objects, etc); you can see the structure in <a href="https://tc39.github.io/ecma262/#sec-code-realms" rel="nofollow">8.2. Realms</a>.</p>
<p>Also, here is an <a href="https://esdiscuss.org/topic/the-initialization-steps-for-web-browsers#content-16" rel="nofollow">es-discuss thread</a>, where Allen Wirfs-Brock (spec editor) explains this in some details.</p>
<p>And one more interesting link for <a href="https://html.spec.whatwg.org/#enqueuejob(queuename,-job,-arguments)" rel="nofollow">EnqueueJob in HTML spec</a>, which says: <em>“Assert: queueName is “PromiseJobs”. (“ScriptJobs” must not be used by user agents.)”</em>.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-208567">
		<article id="comment-208567" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/eb8c9ea0799bf3384e7a02005defa401.jpeg" srcset="http://2.gravatar.com/avatar/eb8c9ea0799bf3384e7a02005defa401?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Ranjit</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208567">
						<time pubdate="" datetime="2017-11-23T02:11:28+00:00">
							2017-11-23						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Awesome Article. Thanks..!!!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208736">
		<article id="comment-208736" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/81abd380ef5cac0e58c9596c8b2d99cd.png" srcset="http://2.gravatar.com/avatar/81abd380ef5cac0e58c9596c8b2d99cd?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Moahmed samih</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208736">
						<time pubdate="" datetime="2017-11-29T11:15:29+00:00">
							2017-11-29						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Really  , i can not find words to say . Thans alot.😀</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208739">
		<article id="comment-208739" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208739">
						<time pubdate="" datetime="2017-11-29T13:27:24+00:00">
							2017-11-29						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<b>Ranjit</b>, @<b>Moahmed samih</b>, thanks for the feedback, guys, appreciated. And glad it’s useful.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208833">
		<article id="comment-208833" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/3f461ecddfb964946caa8b34805a8b68.png" srcset="http://0.gravatar.com/avatar/3f461ecddfb964946caa8b34805a8b68?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Kittsjs</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208833">
						<time pubdate="" datetime="2017-12-03T20:14:33+00:00">
							2017-12-03						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Hi Dmitry,<br>
                  I would like to appreciate the effort put in for writing the tutorial. I have a request of my own, can you please write an article on how promises and generators really work. I am new to these concepts and loose my way very easily when trying to learn these.</p>
<p>Thank You</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208834">
		<article id="comment-208834" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208834">
						<time pubdate="" datetime="2017-12-03T21:39:42+00:00">
							2017-12-03						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Kittsjs</strong>, thanks for the feedback, appreciated! Yes, perhaps I’ll do some round on generators; there are though already good amount of articles on generators and promises on internets.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-208923">
		<article id="comment-208923" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/3f461ecddfb964946caa8b34805a8b68.png" srcset="http://0.gravatar.com/avatar/3f461ecddfb964946caa8b34805a8b68?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Kittsjs</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208923">
						<time pubdate="" datetime="2017-12-06T21:28:19+00:00">
							2017-12-06						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Hi Dmitry,<br>
                   What I actually meant to say was that I do know how to use these, but how do they work internally is what I meant. There are articles out that say how to use these, but I did not find one that states that how do these internally work.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-208924">
		<article id="comment-208924" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-208924">
						<time pubdate="" datetime="2017-12-06T22:35:07+00:00">
							2017-12-06						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Kittsjs</strong>, gotcha! Yeah, we’ll see, maybe I’ll have a write-up on internals of generators, thanks for the suggestion.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-209074">
		<article id="comment-209074" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/7d5aa879a07dac6c6e452f0b5415be0d.jpeg" srcset="http://1.gravatar.com/avatar/7d5aa879a07dac6c6e452f0b5415be0d?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Hong</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-209074">
						<time pubdate="" datetime="2017-12-12T05:32:54+00:00">
							2017-12-12						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Greate Article. Thanks!!!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-209143">
		<article id="comment-209143" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/88ace9eef050bdbf085f054b09f7e241.png" srcset="http://2.gravatar.com/avatar/88ace9eef050bdbf085f054b09f7e241?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Xiaojichao</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-209143">
						<time pubdate="" datetime="2017-12-14T19:42:00+00:00">
							2017-12-14						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Thank you for your great job！</p>
<p>do you mind I translate into Chinese?</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-209144">
		<article id="comment-209144" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-209144">
						<time pubdate="" datetime="2017-12-14T21:09:01+00:00">
							2017-12-14						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Xiaojichao</strong>, great job, thanks! I added the translation.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-209626">
		<article id="comment-209626" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/f4179e7439f8546041973bd654b14bc4.png" srcset="http://0.gravatar.com/avatar/f4179e7439f8546041973bd654b14bc4?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Shahnawaz Sharief</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-209626">
						<time pubdate="" datetime="2018-01-01T00:20:52+00:00">
							2018-01-01						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Hello Dmitry, </p>
<p>First of all, thanks for all these excellent articles. The question I want to ask you is related to execution contexts: when you say ECs are used to “To execute JS code and track its runtime evaluation”, what do you mean by “track”? What is being tracked? Variables? Functions? Is EC an abstraction? Could please explain, with an example. Also, why do we even need execution context in the first place? </p>
<p>Thanks</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-209698">
		<article id="comment-209698" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-209698">
						<time pubdate="" datetime="2018-01-03T21:51:02+00:00">
							2018-01-03						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Shahnawaz Sharief</strong>, thanks for the feedback, appreciated!</p>
<blockquote><p>“To execute JS code and track its runtime evaluation”, what do you mean by “track”? What is being tracked? Variables? Functions? Is EC an abstraction?</p></blockquote>
<p>The generic <a href="https://en.wikipedia.org/wiki/Call_stack" rel="nofollow">call-stack</a> abstraction is used to manage <em>recursive function calls</em>, and store <em>local variables</em>, and <em>parameters</em> of a function.</p>
<p>The <em>execution contexts stack</em> in JS is the extended analogue of the call-stack: besides just storing the local variables, and parameters (in the environment component of EC), it also may store some other components. So a combination of the different components which are needed in order to execute (“track the execution” as we say) the code is called an <em>execution context</em>.</p>
<p>Run the following in Chrome’s console:</p>
<div><div id="highlighter_329935" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">sum(a, b) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">debugger;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">a + b;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript plain">sum(1, 2);</code></div></div></td></tr></tbody></table></div></div>
<p>This opens the debugger console, where you can introspect what is tracked: local variables, parameters, <code>this</code> value, etc.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-211203">
		<article id="comment-211203" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/71eba984dd9f2b44baa2acec66b63406.png" srcset="http://1.gravatar.com/avatar/71eba984dd9f2b44baa2acec66b63406?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">MuradSofi</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211203">
						<time pubdate="" datetime="2018-03-02T03:19:22+00:00">
							2018-03-02						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>In Class section we can do same thing look like this. But what difference this examples? </p>
<div><div id="highlighter_129155" class="syntaxhighlighter dsHightlight jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">letter = </code><code class="jscript keyword">function</code><code class="jscript plain">(name) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.name = name;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.getNumber = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.name;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">}</code></div><div class="line number6 index5 alt1"><code class="jscript plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">x = </code><code class="jscript keyword">new</code> <code class="jscript plain">letter(</code><code class="jscript string">"MuradSofi"</code><code class="jscript plain">)</code></div></div></td></tr></tbody></table></div></div>
<p>Thanks 🙂</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-211228">
		<article id="comment-211228" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211228">
						<time pubdate="" datetime="2018-03-02T11:38:00+00:00">
							2018-03-02						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>MuradSofi</strong>, in this case you create an <em>own</em> function per each <code>letter</code> instance. I.e you create 1000 instances, you’ll get 1000 (the same) functions allocated. And when it’s on prototype (class), it’s allocated <em>once</em>, and is <em>shared</em> across all instances via the inheritance/delegation.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-211377">
		<article id="comment-211377" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/d12ee2445efed2de84f745154da88f12.jpeg" srcset="http://1.gravatar.com/avatar/d12ee2445efed2de84f745154da88f12?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Richard</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211377">
						<time pubdate="" datetime="2018-03-06T15:17:50+00:00">
							2018-03-06						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Two job queue? so what is the priority when the engine needs to fetch a new job?</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-211482">
		<article id="comment-211482" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/8b357a705477abbc44727bbcd5546fa8.png" srcset="http://2.gravatar.com/avatar/8b357a705477abbc44727bbcd5546fa8?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Marco</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211482">
						<time pubdate="" datetime="2018-03-09T11:07:32+00:00">
							2018-03-09						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Great article, but I would like to know something more about “Variable environment”. It’s not mentioned in this article. What is its role? What’s the difference between “lexical environment” and “variable environment”?</p>
<p>Thank you</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-211486">
		<article id="comment-211486" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211486">
						<time pubdate="" datetime="2018-03-09T13:09:16+00:00">
							2018-03-09						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Richard</strong>,</p>
<p>From the <a href="https://tc39.github.io/ecma262/#sec-jobs-and-job-queues" rel="nofollow">spec</a>:</p>
<blockquote><p>This specification does not define the order in which multiple Job Queues are serviced. An ECMAScript implementation may interweave the FIFO evaluation of the PendingJob records of a Job Queue with the evaluation of the PendingJob records of one or more other Job Queues.</p></blockquote>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-211487">
		<article id="comment-211487" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-211487">
						<time pubdate="" datetime="2018-03-09T13:27:47+00:00">
							2018-03-09						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Marco</strong>, thanks, glad it’s useful. The <code>VariableEnvironment</code>, and <code>LexicalEnvironment</code> components are discussed in detail in the appropriate chapter, please refer the <a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-2-lexical-environments-ecmascript-implementation/#variable-environment">ES5.3.2 Lexical Environments</a>.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-217623">
		<article id="comment-217623" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/dc9655eb22b168e39e3178b5b1457f21.png" srcset="http://1.gravatar.com/avatar/dc9655eb22b168e39e3178b5b1457f21?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Nino</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-217623">
						<time pubdate="" datetime="2018-08-15T05:27:32+00:00">
							2018-08-15						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Amazing explanation.<br>
Although i have troubles understanding one thing.<br>
If we have async action which is waiting in event queue for execution stack to get empty, what happens after it gets empty?<br>
Which execution context is created?<br>
Who keeps track of the environment records needed for that action to get executed?</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-218005">
		<article id="comment-218005" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-218005">
						<time pubdate="" datetime="2018-09-10T20:09:15+00:00">
							2018-09-10						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Nino</strong>, at the bottom of the execution context stack there is always the <em>global context</em>. In browser it’s keep alive as long as the window is opened. In Node, once a script is finished, the final (global) context is destroyed, and the execution of a program is completed.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-218388">
		<article id="comment-218388" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/8a9c99017ebb9d082af46a76474359e1.png" srcset="http://2.gravatar.com/avatar/8a9c99017ebb9d082af46a76474359e1?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Vinícius Negrão</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-218388">
						<time pubdate="" datetime="2018-10-04T05:51:08+00:00">
							2018-10-04						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Hi Dmitry,</p>
<p>This is by far the most complete and intuitive article about ECMAScript that I have ever read. It made me understand so much more about the language.</p>
<p>Thank you very much! 😀 Cheers!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-218484">
		<article id="comment-218484" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/882f228c4993ccf0a86e96394636415c(1).jpeg" srcset="http://2.gravatar.com/avatar/882f228c4993ccf0a86e96394636415c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn"><a href="http://dmitrysoshnikov.com/" rel="external nofollow" class="url">Dmitry Soshnikov</a></cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-218484">
						<time pubdate="" datetime="2018-10-09T00:30:43+00:00">
							2018-10-09						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>@<strong>Vinícius Negrão</strong>, thanks, glad it’s useful, and glad to see more people interested in deep JS.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-220564">
		<article id="comment-220564" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/7671d46118b9adc8ed706dfd97f8dbbe.png" srcset="http://1.gravatar.com/avatar/7671d46118b9adc8ed706dfd97f8dbbe?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Sylvain Boulade</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-220564">
						<time pubdate="" datetime="2019-01-08T04:52:36+00:00">
							2019-01-08						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Very cool article Dmitry ! Insightful, thorough, yet easy to read and understand.</p>
<p>Thanks for taking the time to write it.</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-220729">
		<article id="comment-220729" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/be8c187b5af6260858726690ad1f150c.png" srcset="http://2.gravatar.com/avatar/be8c187b5af6260858726690ad1f150c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Joachim Kamieth</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-220729">
						<time pubdate="" datetime="2019-01-15T10:45:41+00:00">
							2019-01-15						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>I solely did read german translation, however, amasingly clear and comprehensable! Pls. more of stuff like that 😀</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-221967">
		<article id="comment-221967" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/597cb27fd4cdd18e56c990fe30dc40d6.png" srcset="http://2.gravatar.com/avatar/597cb27fd4cdd18e56c990fe30dc40d6?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">					<cite class="fn">Sajid</cite>									</div>
				<!-- .comment-author .vcard -->
				<div class="comment-meta commentmetadata">
					<a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/#comment-221967">
						<time pubdate="" datetime="2019-03-10T06:59:47+00:00">
							2019-03-10						</time>
					</a>
									</div>
				<!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content "><p>Thanks Dmitry<br>
This was awesome!</p>
</div>

			<div class="reply">
							</div>
			<!-- .reply -->
		</article><!-- #comment-## -->
	</li><!-- #comment-## -->
			</ol><!-- .commentlist -->

			
		
		
		
			
			<div id="share-comment-button-bottom" style="display: block;">
				<button>
					<i class="share-comment-icon"></i>Write a Comment				</button>
			</div>
			<div id="commentform-bottom" style="display: none;"></div> <!-- do not remove; used by jQuery to move the comment reply form here -->
		
							
							
	</div><!-- #comments .comments-area -->


				
																			<div id="taglist">
						<ul class="taglist"><li class="taglist-title">Related Content by Tag</li><li><a href="http://dmitrysoshnikov.com/tag/closure/" rel="tag">Closure</a></li><li><a href="http://dmitrysoshnikov.com/tag/core/" rel="tag">Core</a></li><li><a href="http://dmitrysoshnikov.com/tag/ecmascript/" rel="tag">ECMAScript</a></li><li><a href="http://dmitrysoshnikov.com/tag/funarg/" rel="tag">Funarg</a></li><li><a href="http://dmitrysoshnikov.com/tag/javascript/" rel="tag">JavaScript</a></li><li><a href="http://dmitrysoshnikov.com/tag/lexical-environment/" rel="tag">lexical environment</a></li><li><a href="http://dmitrysoshnikov.com/tag/prototype/" rel="tag">Prototype</a></li><li><a href="http://dmitrysoshnikov.com/tag/this/" rel="tag">this</a></li></ul>					</div>
				
			
		</main>
		<!-- #content .site-content -->
	</div><!-- #primary .content-area -->

<div id="secondary" class="widget-area" role="complementary">
	</div><!-- #secondary .widget-area -->

</div><!-- #main .site-main -->

<footer id="colophon" class="site-footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter" role="contentinfo">
	<div class="site-info">
		<a href="http://independentpublisher.me/" rel="designer" title="Independent Publisher: A beautiful reader-focused WordPress theme, for you.">Independent Publisher</a> empowered by <a href="http://wordpress.org/" rel="generator" title="WordPress: A free open-source publishing platform">WordPress</a>	</div>
	<!-- .site-info -->
</footer><!-- #colophon .site-footer -->
</div><!-- #page .hfeed .site -->

<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/form.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shCore.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/shBrushJScript.js.download"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://dmitrysoshnikov.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://dmitrysoshnikov.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['class-name'] = 'dsHightlight';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['tab-size'] = 2;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.defaults['wrap-lines'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/skip-link-focus-fix.js.download"></script>
<script type="text/javascript" src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/wp-embed.min.js.download"></script>
<!--stats_footer_test--><script src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/e-201929.js.download" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'12310956',v:'ext',post:'3213'});
var load_cmc = function(){linktracker_init(12310956,3213,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script><img src="./JavaScript. The Core_ 2nd Edition – Dmitry Soshnikov_files/g.gif" alt=":)" width="6" height="5" id="wpstats">



</body></html>